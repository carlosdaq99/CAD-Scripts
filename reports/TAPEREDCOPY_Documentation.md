# 🎯 TAPERED COPY ALONG CURVE - AutoLISP Documentation

## 📋 Overview

The **TAPEREDCOPY** command creates multiple scaled-down copies of a selected object along a user-defined curve, with both the object scale and spacing between instances decreasing linearly from start to end.

## 🚀 Features

### ✅ Core Functionality
- **Linear scaling**: Objects scale from 1.0 down to a minimum scale
- **Decreasing spacing**: Distance between objects decreases along the curve
- **Curve compatibility**: Works with splines, arcs, polylines, and any `vlax-curve` compatible object
- **Flexible parameters**: User-defined number of copies and minimum scale

### ✅ Advanced Features
- **Tangent alignment**: Optional rotation of objects to follow curve direction
- **Error handling**: Comprehensive validation and user feedback
- **Progress indicators**: Visual feedback during placement
- **Legacy compatibility**: Maintains compatibility with existing `ScaleCopyAlongCurve` function

## 🔧 Usage

### Command Execution
```
Command: TAPEREDCOPY
```

### Step-by-Step Process
1. **Select Object**: Choose the object to copy and scale
2. **Base Point**: Specify the insertion point on the object
3. **Select Curve**: Choose the path (spline, arc, polyline, etc.)
4. **Parameters**:
   - Number of copies (default: 10, max: 1000)
   - Minimum scale factor (default: 0.1)
   - Tangent alignment option (Yes/No)

## 📐 Mathematical Implementation

### Scaling Formula
```
scale_i = max(min_scale, 1 - i/N)
```
Where:
- `i` = copy index (1 to N)
- `N` = total number of copies
- `min_scale` = minimum scale factor

### Spacing Formula
```
spacing_k = const × (1 - k/N)
cumulative_distance_i = Σ(spacing_k) for k=1 to i
```
Where:
- `const` = normalization factor to ensure total equals curve length
- Spacing decreases linearly from start to end

## 🔧 Technical Requirements

### AutoCAD Compatibility
- **AutoCAD Version**: 2018 or later
- **Dependencies**: AutoLISP with ActiveX support (`vlax-*` functions)
- **No external libraries**: Pure AutoLISP implementation

### Supported Curve Types
- Splines (NURBS curves)
- Arcs and circles
- Polylines (2D and 3D)
- Lines
- Any object supporting `vlax-curve` methods

## 📊 Performance Characteristics

### File Size and Efficiency
- **Script size**: ~9.7 KB (within 15KB guideline)
- **Memory usage**: Minimal, processes objects sequentially
- **Execution time**: Linear with number of copies

### Limitations
- **Maximum copies**: 1000 (performance safeguard)
- **Minimum scale**: User-defined (default 0.1)
- **Curve length**: Must be > 0.001 units

## 🧪 Testing and Validation

### Automated Tests Included
1. **Syntax validation**: Parentheses balance, function definitions
2. **Mathematical validation**: Formula correctness, edge cases
3. **Error handling**: Boundary conditions, invalid inputs

### Test Results
✅ All syntax tests passed  
✅ Mathematical formulas validated  
✅ Error handling verified  
✅ Performance within guidelines  

## 🔄 Backwards Compatibility

The original `ScaleCopyAlongCurve` function is preserved and redirects to the new `TAPEREDCOPY` command, ensuring existing workflows continue to function.

## 🛠️ Installation

1. Load the `.lsp` file in AutoCAD:
   ```
   (load "ScaleCopyAlongCurve.lsp")
   ```
2. Or place in AutoCAD's startup folder for automatic loading

## 📝 Example Usage Scenarios

### Architectural Applications
- Decreasing fence posts along curved boundaries
- Tapered lighting fixtures along pathways
- Scaled vegetation along landscape curves

### Mechanical Design
- Decreasing fasteners along curved assemblies
- Tapered cooling fins on curved surfaces
- Variable-size components along curved paths

### Artistic Applications
- Perspective effects with diminishing objects
- Decorative patterns with size variation
- Dynamic compositions along curved forms

## 🐛 Troubleshooting

### Common Issues
1. **"Not a valid curve"**: Ensure selected object supports `vlax-curve` methods
2. **"Curve length too small"**: Check curve geometry and units
3. **Command interruption**: Use UNDO to revert partial operations

### Error Recovery
- Built-in error handler restores system variables
- Progress indicators help identify interruption points
- Legacy function fallback for compatibility

## 🔮 Future Enhancements

### Planned Features
- **DCL Dialog Interface**: GUI for parameter input
- **Exponential/Logarithmic spacing**: Alternative distribution curves
- **Mirror alternation**: Objects on alternating sides of curve
- **Block insertion**: Enhanced object type support

### Extension Points
- Custom scaling functions
- Multiple curve support
- Batch processing capabilities
- Preview mode with temporary geometry

---

*Generated by GitHub Copilot • July 26, 2025*
